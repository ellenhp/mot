<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MapLibre Vector Tile Routing</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div id="map"></div>
  <pre id="hover_properties"></pre>

  <pre id="editor">class CostingModel {
  cost_intersection(current_way_tags, transition_array) {
    try {
      var costs = [];
      var any_are_big = false;
      var any_are_huge = false;
      for (let index = 0; index < transition_array.length; index++) {
        const element = transition_array[index];
        var penalty;
        let way_tags = element.to_way_tags;
        let is_footpath = way_tags.get('highway') === "footway";
        if (is_footpath) {
          penalty = 10.0
        } else {
          penalty = 20.0
        }
        costs.push({
          to_way_id: element.to_way_id,
          penalty_seconds: penalty
        })
        any_are_big = any_are_big || (['primary', 'secondary'].includes(way_tags.get('highway')) && way_tags.get('bridge') === current_way_tags.get('bridge'))
        any_are_huge = any_are_huge || (['trunk', 'motorway'].includes(way_tags.get('highway')) && way_tags.get('bridge') === current_way_tags.get('bridge'))
      }
      var continuation_penalty = 0.0;
      if (any_are_big) {
        continuation_penalty = continuation_penalty + 30;
      }
      if (any_are_huge) {
        continuation_penalty = continuation_penalty + 120;
      }
      return {
        transition_costs: costs,
        continue_penalty: continuation_penalty,
      }
    } catch (err) {
      console.log(err)
      return {
        transition_costs: [],
      }
    }
  }
  cost_way(way) {
    var base_speed = 1.4
    var penalty = 0
    if (way.get('highway') !== 'footway') {
      penalty = 0.05
    }
    if (['trunk', 'trunk_link', 'motorway', 'motorway_link'].includes(way.get('highway'))) {
      base_speed = undefined;
    }
    if ([way.get('sidewalk'), way.get('sidewalk:left'), way.get('sidewalk:right'), way.get('sidewalk:both')].includes('separate')) {
      base_speed = undefined;
    }
    return {
      speed_forward_meters_per_second: base_speed,
      speed_reverse_meters_per_second: base_speed,
      time_penalty_fraction_forward: penalty,
      time_penalty_fraction_reverse: penalty,
    };
  }
}
new CostingModel()
</pre>

  <script src="index.js"></script>


</body>

</html>