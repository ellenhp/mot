# Connection keep alive timeout [default: 75]
keep_alive: 75

# The socket address to bind [default: 0.0.0.0:3000]
listen_addresses: '0.0.0.0:3000'

# Set TileJSON URL path prefix. This overrides the default of respecting the X-Rewrite-URL header.
# Only modifies the JSON (TileJSON) returned, martins' API-URLs remain unchanged. If you need to rewrite URLs, please use a reverse proxy.
# Must begin with a `/`.
# Examples: `/`, `/tiles`
base_path: /

# Number of web server workers
worker_processes: 8

# Amount of memory (in MB) to use for caching tiles [default: 512, 0 to disable]
cache_size_mb: 512

# If the client accepts multiple compression formats, and the tile source is not pre-compressed, which compression should be used. `gzip` is faster, but `brotli` is smaller, and may be faster with caching.  Default could be different depending on Martin version.
preferred_encoding: gzip

# Enable or disable Martin web UI. At the moment, only allows `enable-for-all` which enables the web UI for all connections. This may be undesirable in a production environment. [default: disable]
web_ui: enable-for-all

# Advanced monitoring options
observability:
  # Configure metrics reported under `/_/metrics`
  metrics:
    # Add these labels to every metric
    # Example: `{ env: prod, server: martin }`
    add_labels: {}

# Database configuration. This can also be a list of PG configs.
postgres:
  # Database connection string.
  #
  # You can use environment variables too, for example:
  connection_string: 'postgresql:///osm?user=$USER&host=/var/run/postgresql&sslmode=disable'

  # Limit the number of geo features per tile.
  #
  # If the source table has more features than set here, they will not be included in the tile and the result will look "cut off"/incomplete.
  # This feature allows to put a maximum latency bound on tiles with extreme amount of detail at the cost of not returning all data.
  # It is sensible to set this limit if you have user generated/untrusted geodata, e.g. a lot of data points at [Null Island](https://en.wikipedia.org/wiki/Null_Island).
  max_feature_count: null # either a positive integer, or null=unlimited (default)

  # Specify how bounds should be computed for the spatial PG tables [default: quick]
  # 'calc' - compute table geometry bounds on startup.
  # 'quick' - same as 'calc', but the calculation will be aborted if it takes more than 5 seconds.
  # 'skip' - do not compute table geometry bounds on startup.
  auto_bounds: calc

  # Associative arrays of table sources
  tables:
    wof_admins:
      schema: public
      table: wof_admins
      srid: 4326
      geometry_column: geom
      id_column: id
      minzoom: 14
      maxzoom: 14
      extent: 4096
      buffer: 1024
      clip_geom: true
      geometry_type: GEOMETRY
      properties:
        admin_level: text
        names: text

    poi:
      schema: public
      table: poi
      srid: 4326
      geometry_column: geom
      id_column: id
      minzoom: 10
      maxzoom: 14
      extent: 16384
      buffer: 512
      clip_geom: true
      geometry_type: GEOMETRY
      properties:
        way_id: int8
        node_id: int8
        tags: jsonb

    intersections:
      schema: public
      table: intersections
      srid: 4326
      geometry_column: geom
      minzoom: 14
      maxzoom: 14
      extent: 4096
      buffer: 1024
      clip_geom: true
      geometry_type: GEOMETRY
      properties:
        way_id: int8
        transition_to_way: int8
        distance_along_way: float
        transition_to_distance_along_way: float
        restriction_tags: jsonb

    roads:
      schema: public
      table: roads
      srid: 4326
      geometry_column: geom
      minzoom: 10
      maxzoom: 14
      extent: 4096
      buffer: 1024
      clip_geom: true
      geometry_type: GEOMETRY
      properties:
        way_id: int8
        tags: jsonb